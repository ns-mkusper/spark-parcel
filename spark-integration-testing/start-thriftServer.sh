export SPARK_CONF_DIR=/etc/spark/conf.cloudera.spark_on_yarn

/opt/cloudera/parcels/YSPARK/lib/spark/sbin/stop-thriftserver.sh 
/opt/cloudera/parcels/YSPARK/lib/spark/sbin/start-thriftserver.sh --name spark-integration-testing-thriftserver --queue tandem  --executor-memory 12g --total-executor-cores 400 --driver-memory 12g --executor-cores 5 --hiveconf hive.server2.thrift.port=30403 --conf spark.yarn.executor.memoryOverhead=8192  --conf spark.dynamicAllocation.enabled=true  --conf spark.shuffle.service.enabled=true --conf spark.dynamicAllocation.minExecutors=0 --conf spark.dynamicAllocation.maxExecutors=300 --conf spark.dynamicAllocation.executorIdleTimeout=200 --conf "spark.driver.extraJavaOptions=-XX:+UseG1GC" --conf "spark.executor.extraJavaOptions=-XX:+UseParallelGC -XX:+UseParallelOldGC  -Djava.net.preferIPv4Stack=true -XX:+PrintFlagsFinal -XX:+PrintReferenceGC -verbose:gc -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintAdaptiveSizePolicy -XX:+UnlockDiagnosticVMOptions" --hiveconf hive.server2.thrift.bind.host=10.17.221.20
